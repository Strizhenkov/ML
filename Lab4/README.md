[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-22041afd0340ce965d47ae6ef1cefeee28c7c493a6346c4f15d667ab976d596c.svg)](https://classroom.github.com/a/X4ZdjFuc)
# lab-template

В качестве таргета для работы было выбрано решение задачи класификации отзывов от 1 до 5 на основании текста используя текстовую модель состоящую из нескольких слоев.

В качестве датасета была выбрана совокупность отзывов по 4 последним фильтрам вселенной "Star Wars" с сайта https://www.rottentomatoes.com/. Отзывы отбирались следующим образом:
1) Отзыв должен быть от критика, а не от обычного пользователя. Это позволяет избежать потенциальных шумов, так как текст отзыва критика более конструктивен и логически связан, чем отзыв среднестатистического пользователя.
2) Отзыв должен обязательно содержать оценку в одной из различных класификаций (A-F; 1-5; 1-100; 1-10 и тд)

Все отзывы были приведены к общему виду (1-5) для удобства класификации моделью. Из текста были убраны все знаки пунктуации и прочие, а также снижен регистр у всех заглавных букв. Это нужно для уменьшения словаря в процессе обучения.

Все слова в каждом отзыве были закодированы числом от 1 до n (кол разных слов), путем помещения в словарь и сами тексты были соотвественно преобразованы в числовые последовательности. Затем датасет был адаптирован к использованию элементами библиотеки PyTorch.
Сам датасет был разбит в соотношении 80%/20% обучающая и тестовая выборка соответственно.
Затем была создана вспомогательная функция для подготовки данных в каждом батче для модели. Она нужна для для корректировки LSTM.

Сама модель состоит из следующих слоев:
1) nn.Embedding
2) nn.LSTM
3) nn.BacthNorm1d
4) nn.Dropout
5) nn.Linear
Модель реализована с наследованием от родительского базового класса из PyTorch. Реализовано разделение инициализации архитектуры и самой обработки данных через модель, что позволяет к примеру удобно менять порядок выполняемых слоев и также обеспечивает совместимость с библиотекой.

Для вычисления функции потерь была взята стандартная функция кроссэнтропии для задач класификации.
Также был добавлен регулятор L2 на основе модификации градиента для избежания переобучения.
Затем были созданы 2 основные функции для обучения и вычисления результата:
1) TrainModel обучает модель определенное количество эпох с вычислением потерь и последующих корректировок для следующего этапа.
2) Evaluatemodel оценивает модель на наборе данных подсчетом Accuracy как соотношение верно класифицированных к общему количеству, для сравнения с ответом выбирается класс с наибольшей вероятностью.
